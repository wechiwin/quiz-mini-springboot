<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Studiamo l'italiano</title>
    <!--    <script src="/common/common-js.js" type="application/javascript"></script>-->
    <!--    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>-->
    <!--    <script type="text/javascript" src="https://cdn.bootcss.com/vue/2.5.17-beta.0/vue.js"></script>-->
    <!--    <script src="/js/axios.min.js" type="application/javascript"></script>-->
    <!--    <script src="/js/vue@2.6.20.min.js" type="application/javascript"></script>-->
    <script type="text/javascript" th:src="@{/static/js/jquery.min.js}"></script>
    <script type="text/javascript" th:src="@{/static/js/vue@2.6.20.min.js}"></script>
</head>
<body>
<div id="app" th:attr="data-cardList=${cardList}">
    <div class="header">
        <a th:href="@{/}" class="header-text">Studiamo!</a>
    </div>

    <div>
        <div>
            <h2>
                Categoria: <span th:text="${folder.foName}">nome</span>
            </h2>
        </div>


        <div class="list-item" v-for="(question, index) in cardList">
            <!--            <div v-show="(index+1)==currentQuestionIndex">-->
            <div>
                <h2>
                    {{ index + 1 }}. {{ question.verb }} -- {{ question.grammaticalPerson }}
                </h2>
                <div class="inputArea">
                    <label>
                        <input type="text" spellcheck="false" id="inputText" v-model="userAnswer">
                    </label>
                    <button>
                        Controlla
                    </button>
                </div>
            </div>
        </div>


        <!--            <div class="list-item" th:each="card, cardStat : ${cardList}" th:if="${cardStat.index== 0}"-->
        <!--                 id="firstQuestion">-->
        <!--                <h2>-->
        <!--                    <span th:text="${cardStat.count}"></span>. <span th:text="${card.verb}"></span> &#45;&#45; <span-->
        <!--                        th:text="${card.grammaticalPerson}"></span>-->
        <!--                </h2>-->

        <!--                <div class="inputArea">-->
        <!--                    <label>-->
        <!--                        <input type="text" spellcheck="false" id="firstInputText">-->
        <!--                    </label>-->
        <!--                    <button th:onclick="handleControlAnswer(0)">Controlla</button>-->
        <!--                </div>-->
        <!--            </div>-->

        <!--            <div class="list-item" th:each="card, cardStat : ${cardList}" th:id="questions">-->
        <!--                <h2>-->
        <!--                    <span th:text="${cardStat.count}"></span>. <span th:text="${card.verb}"></span> &#45;&#45; <span-->
        <!--                        th:text="${card.grammaticalPerson}"></span>-->
        <!--                </h2>-->
        <!--                <div class="inputArea">-->
        <!--                    <label>-->
        <!--                        <input type="text" spellcheck="false" id="inputText">-->
        <!--                    </label>-->
        <!--                    <button th:onclick="'handleControlAnswer(' + ${cardStat.index} + ', ' + ${cardStat.count} + ')'">-->
        <!--                        Controlla-->
        <!--                    </button>-->
        <!--                </div>-->
        <!--            </div>-->


        <div>
            <!-- 在 th:attr 中设置动态内容 -->
            <button th:attr="data-content='è'" th:onclick="handlePaste(this)" class="copyButton">è</button>
            <button th:attr="data-content='ò'" th:onclick="handlePaste(this)" class="copyButton">ò</button>
            <button th:attr="data-content='à'" th:onclick="handlePaste(this)" class="copyButton">à</button>
            <button th:attr="data-content='ì'" th:onclick="handlePaste(this)" class="copyButton">ì</button>
            <button th:attr="data-content='ù'" th:onclick="handlePaste(this)" class="copyButton">ù</button>

        </div>

        <hr/>

        <div>
            <p>Numero: <span>{{ currentQuestionIndex }} / {{ cardList.length }}</span></p>
            <p class="score">Punti: {{score}} </p>
            <div>
                <button @click="handlePrevNext('prev')">←</button>
                <button @click="handlePrevNext('next')">→</button>
            </div>
        </div>


    </div>


</div>

<script type="text/javascript">
    new Vue({
        el: '#app',
        data() {
            return {
                isCorrect: false,
                score: 0,
                currentQuestionIndex: 1,
                cardList: [],
                // cardList: data - cardList,
                total: 0,
                isCompleted: false,
                userAnswer: '',
                userAnswerList: [],
            }
        },
        mounted() {
            this.getPkid()
        },
        methods: {
            handlePrevNext(flag) {
                if (flag === 'prev') {
                    this.currentQuestionIndex -= 1
                } else {
                    this.currentQuestionIndex += 1
                }
                if (this.currentQuestionIndex < 0) {
                    this.currentQuestionIndex = 1
                } else if (this.currentQuestionIndex === this.total) {
                    this.currentQuestionIndex = this.total
                    this.isCompleted = true
                }

            },
            getPkid() {
                // Get the current URL
                var currentUrl = window.location.href;

                var regex = /\/quiz\/card\/listByFoPkid\/(-?\d+)/;
                var match = currentUrl.match(regex);

                if (match && match.length > 1) {
                    // Extracted parameter value
                    var foPkid = match[1];

                    // Now 'foPkid' contains the value "-1621147646"
                    console.log('foPkid:', foPkid);
                    this.foPkid = foPkid

                } else {
                    console.log('Parameter not found');
                }
            },
            getQuestions(foPkid) {
                // this.cardList = [
                //     {id: 1, q: 'aaa'},
                //     {id: 2, q: 'bbb'},
                // ]

                var param = {
                    foPkid
                }
                $.ajax({
                    type: "POST",
                    url: "/quiz/card/searchList",
                    data: JSON.stringify(param),
                    dataType: "json",
                    contentType: "application/json",
                    success: function (result) {
                        if (result.status == 200) {
                            console.log(result)
                            this.cardList = result.data;
                            console.log('cardList', this.cardList)
                        }
                    }
                });


            }
        }
    })
</script>

<script th:inline="javascript">
    /*<![CDATA[*/
    function handleControlAnswer(index, count) {
        if (index == 0) {
            console.log('ok')
            var firstQuestionDiv = document.getElementById('firstQuestion');
            firstQuestionDiv.classList.add('hideQuestion');
            document.getElementById('question2').classList.remove('hideQuestion')
        }
        console.log(count)
    }

    function handlePaste(button) {
        // 获取按钮上的动态内容
        var dynamicContent = button.getAttribute('data-content');

        // 创建一个临时的textarea元素
        var tempTextarea = document.createElement("textarea");
        // 设置textarea的值为要复制的内容
        tempTextarea.value = dynamicContent;
        // 设置textarea的值为动态内容
        tempTextarea.value = dynamicContent;
        // 将textarea添加到DOM中
        document.body.appendChild(tempTextarea);
        // 选择textarea的内容
        tempTextarea.select();
        // 执行复制操作
        document.execCommand('copy');
        // 从DOM中移除textarea
        document.body.removeChild(tempTextarea);

        // 将复制的内容粘贴到input框中
        document.getElementById('inputText').value += dynamicContent;

        // 这里可以添加其他处理逻辑，例如提示用户复制成功
        // alert('Copied: ' + dynamicContent);
    }


    /*]]>*/
</script>

</body>

<!--<script th:src="@{/static/js/axios.min.js}"></script>-->
<!--<script th:src="@{/static/js/common.js}"></script>-->
<!--<script th:src="@{/static/js/vue@2.6.20.min.js}"></script>-->

<style>
    body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-family: 'Arial', sans-serif;
        background-color: #f5f8fa;
        padding: 0;
    }

    code {
        font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
        monospace;
    }

    h2 {
        font-size: 2em;
    }

    #app {
        text-align: center;
    }

    .header {
        padding: 10px 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        /*width: 100vw;*/
        /*background-color: #bcd2e8; !* Twitter-like blue background color *!*/
        /*border-bottom: 1px solid #0f89d1; !* Slightly darker border color *!*/
    }

    .header-text {
        color: #1da1f2;
        text-decoration: underline;
        text-align: center;
        display: block;
        font-size: 2em;
        margin-block-start: 0.67em;
        margin-block-end: 0.67em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        font-weight: bold;
    }

    p {
        color: #66757f;
        margin-top: 10px;
    }

    button {
        padding: 10px 20px;
        margin: 10px;
        border: none;
        border-radius: 25px;
        font-size: 16px;
        cursor: pointer;
        background-color: #1da1f2;
        color: #fff;
        transition: background-color 0.3s ease;
    }

    button:hover {
        background-color: #0e81d4;
    }

    button:disabled {
        background-color: darkgrey;
        cursor: not-allowed;
    }

    .copyButton {
        color: #1da1f2;
        background: azure;
    }

    .copyButton:hover {
        color: white;
        /*font-weight: bold;*/
        /*background: coral;*/
    }

    input {
        padding: 10px;
        margin: 5px;
        border: 1px solid #e1e8ed;
        border-radius: 5px;
        font-size: 16px;
    }

    textarea {
        padding: 10px;
        margin: 5px;
        border: 1px solid #e1e8ed;
        border-radius: 5px;
        font-size: 18px;
        font-family: 'Arial', sans-serif;
        width: 400px;
        height: 100px;
    }

    .hideQuestion {
        display: none;
    }

    .showQuestion {
        display: block;
    }

</style>

</html>